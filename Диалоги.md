По сути своей, диалоги это программируемая [система нодов](./Nodes), которая позволяет вам создавать развилистые разговоры для ваших карт. Диалоги основаны на нодовой системе событий, поэтому является возможным также исполнять различные действия (к примеру команды или условия), или подключать разные ветки диалогов в зависимости от состояний игрока.
 
Диалоги можно вызвать также посредством [триггеров](./Trigger), или [командой](https://github.com/mchorse/mappet/wiki/Commands#dialogue-commands) `/mp dialogue open`.
 
Диалогами можно управлять в [главной панели Маппет](./Mappet-dashboard). Четвёртая панель в левом боковом меню откроет редактор диалогов.
 
## Редактирование
 
Как только вы создадите или выберете диалог, вы увидите вот такой редактор:
 
![Редактор диалогов](https://i.imgur.com/vbNscqe.png)
 
Диалоговая система нодов поддерживает следующие типы нодов:
 
* **Все** ноды событий (кроме нода **Таймер**)
* Нод **Ответ** позволяет дать ответ в диалоге из опций, которые выбирает игрок
* Нод **Реакция** позволяет дать реакцию (по сути тот же ответ) в диалоге от того, с кем игрок имеет диалог
* Нод **Крафт** позволяет открыть рецепт крафта, который будет предложен игроку в качестве бартера
* Нод **Квест** позволяет выдавать игроку новые квесты или принимать уже завершенные
 
### Нод "Ответ"
 
Нод ответа даёт игроку возможность выбрать определённый ответ из предложенных ответов в диалоге. Поле **Содержание** позволяет вам написать текст, который игрок будет использовать в качестве ответа в диалоге. Вы можете использовать то же форматирование, что и в [описаниях квестов](./Quests#descriptions-formatting). Также, вы можете выбрать цвет текста используя средство выбора под полем содержания.
 
### Нод "Реакция"
 
Нод "Реакция" предоставляет реакцию NPC либо на начало диалога, либо на ответ игрока. Поле **Content** позволяет вам написать текст, которы allows you to provide the text that a player will be replying to the dialogue. You can use same formatting as with [quest's description](./Quests#descriptions-formatting). While the color picker underneath allows you to set the main text color.
 
And the Pick | Edit buttons underneath allow you to pick a morph that will be displayed in the dialogue screen on the right of the main panel. You can use any morph, however, `particle` with vanilla emission mode and `snowstorm` morphs **won't work**! Other morph features like pose animations should be working when transitioning to the next reaction after player picked a reply.
 
### Нод "Крафт"
 
Crafting node offers crafting table to the player within the dialogue by given ID under **Crafting table** label. 
 
### Нод "Квест"
 
Quest node offers quest(s) to the player based on the quest chain by given ID under **Quest chain** label. Keep in mind that the dialogue will display the quests only that ones that match the quest giver/receiver properties within the quest chain. See [quest chains](./Quest-chains#quest-node) page for more info.
 
## Иерархия
 
Так же, как и с событиями, вам необходимо [указать главный нод](./Events#hierarchy). Однако, кроме указания главного нода есть ещё и определённый порядок исполнения нодов, которого вам нужно придерживаться. Взгляните на этот пример: 
 
![Пример диалога](https://i.imgur.com/GO9qmEl.png)
 
Для каждой стадии диалога, вам необходим нод "Реакция" и либо:
 
* Один нод "Квест"
* Один нод "Крафт"
* Один или более нодов "Ответ"
 
Но реакции обязательно должен иметь по крайней мере непрямую связь с **хотя бы одним** из этих нодов. Взгляните на следующий диалог:
 
![Пример диалога с большей сложностью](https://i.imgur.com/GDrmfVv.png)
 
Вы можете добавлять дополнительные ноды "Состояние", "Переключатель" и "Команда" в качестве исходящих нодов от нодов "Ответ", "Реакция", "Крафт" или "Квест", или даже между ними. Самая важная часть заключается в том, что на каждую стадию диалога у вас должен быть один нод "Реакция", присоединённый к минимум одному ноду "Ответ", ил иже к одиночным нодам "Крафт" или "Квест". Тем не менее, **Нод "Реакция" никогда нельзя соединять с другим нодом "Реакция"** без посредника в виде нодов "Ответ", "Крафт" или "Квест", во всех иных случаях у вас выйдут непоследовательности.
 
Напоследок, вам стоит привязывать ноды "Ответ", "Крафт" или "Квест" к другим нодам "Реакция", если вы хотите отправить игрока в начало или какую-либо другю точку диалога, что и происходит с нодом `quest`, привязанному к ноду `Hi!`, который вернёт игрока на начало диалога. Если на его месте не будет нода "Ответ", "Крафт" или "Квест", то **диалог закочнится**.
 
## Механики
 
Стоит сказать, что у диалогов есть всего одна специальная мехника, о которой вам нужно знать.
 
**Как только игрок откроет диалог**, к состоянию с ID `dialogue.DIALOGUE_ID` будет добавлена `1`. Так что, если игрок открыл диалог `mchorse.greetings`, то к состоянию игрока `dialogue.mchorse.greetings` будет добавлена `1` (вы можете проверить это посредством открытия диалога и исполнения команды `/mp state print YOUR_USERNAME`).
