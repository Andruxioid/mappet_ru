По сути своей, диалоги это программируемая [система нодов](./Nodes), которая позволяет вам создавать развилистые разговоры для ваших карт. Диалоги основаны на нодовой системе событий, поэтому является возможным также исполнять различные действия (к примеру команды или условия), или подключать разные ветки диалогов в зависимости от состояний игрока.
 
Диалоги можно вызвать также посредством [триггеров](./Trigger), или [командой](https://github.com/mchorse/mappet/wiki/Commands#dialogue-commands) `/mp dialogue open`.
 
Диалогами можно управлять в [главной панели Маппет](./Mappet-dashboard). Четвёртая панель в левом боковом меню откроет редактор диалогов.
 
## Редактирование
 
Как только вы создадите или выберете диалог, вы увидите вот такой редактор:
 
![Редактор диалогов](https://i.imgur.com/vbNscqe.png)
 
Диалоговая система нодов поддерживает следующие типы нодов:
 
* **Все** ноды событий (кроме нода **Таймер**)
* Нод **Ответ** позволяет дать ответ в диалоге из опций, которые выбирает игрок
* Нод **Реакция** позволяет дать реакцию (по сути тот же ответ) в диалоге от того, с кем игрок имеет диалог
* Нод **Крафт** позволяет открыть рецепт крафта, который будет предложен игроку в качестве бартера
* Нод **Квест** позволяет выдавать игроку новые квесты или принимать уже завершенные
 
### Нод "Ответ"
 
Но довтета даёт игроку возможность выбрать определённый ответ из предложенных ответов в диалоге. Поле **Содержание** позволяет вам написать текст, который игрок будет использовать в качестве ответа в диалоге. Вы можете использовать то же форматирование, что и в [описаниях квестов](./Quests#descriptions-formatting). Также, вы можете выбрать цвет текста используя средство выбора под полем содержания.
 
### Нод "Реакция"
 
Reaction node provides a reaction to either dialogue initiation or to a reply. **Content** field allows you to provide the text that a player will be replying to the dialogue. You can use same formatting as with [quest's description](./Quests#descriptions-formatting). While the color picker underneath allows you to set the main text color.
 
And the Pick | Edit buttons underneath allow you to pick a morph that will be displayed in the dialogue screen on the right of the main panel. You can use any morph, however, `particle` with vanilla emission mode and `snowstorm` morphs **won't work**! Other morph features like pose animations should be working when transitioning to the next reaction after player picked a reply.
 
### Нод "Крафт"
 
Crafting node offers crafting table to the player within the dialogue by given ID under **Crafting table** label. 
 
### Нод "Квест"
 
Quest node offers quest(s) to the player based on the quest chain by given ID under **Quest chain** label. Keep in mind that the dialogue will display the quests only that ones that match the quest giver/receiver properties within the quest chain. See [quest chains](./Quest-chains#quest-node) page for more info.
 
## Иерархия
 
Same as with events, you have to [specify the main node](./Events#hierarchy). However, beside specifying main node there are some specific order of node execution you must follow. Take a look at this example: 
 
![Sample dialogue](https://i.imgur.com/GO9qmEl.png)
 
For every stage in the dialogue, you need to have one Reaction node and either:
 
* One Quest node
* One Crafting node
* One or more Reply nodes
 
You have to have at least **one of those** connected to a Reaction node indirectly. Consider following dialogue:
 
![Sample dialogue with more complexity](https://i.imgur.com/GDrmfVv.png)
 
You can have additional Condition, Switch and Command nodes anywhere coming out of Reply, Reaction, Craft and Quest nodes, or even in between. The most important part is that per every dialogue stage you'd have one Reaction node connected to multiple Reply nodes, or a single Craft or Quest nodes. However, **Reaction node should never be connected to another Reaction node** without passing through a Reply, Craft or Quest nodes otherwise you'll have inconsistencies.
 
The final thing to note is that you should connect Reply, Crafting or Quest nodes to another Reaction node when you want to redirect the dialogue back, as you can see with the `quest` node that is connected back to `Hi!`. Which will return the place back to the beginning of the dialogue. If there will be no Reply, Crafting or Quest nodes down the line, then **the dialogue will end**.
 
## Mechanics
 
It worth noting that there is one special mechanic that you need to know about dialogues. 
 
**Once a dialogue is opened by a player** a `1` will be added to that player's state by key `dialogue.DIALOGUE_ID`. So if a player opened dialogue `mchorse.greetings`, then to the player states a `1` will be added to the key `dialogue.mchorse.greetings` (you can verify that by opening a dialogue and executing `/mp state print YOUR_USERNAME`).
